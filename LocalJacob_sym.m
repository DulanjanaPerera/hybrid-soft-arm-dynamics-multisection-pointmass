function [PosJ, RotJ] = LocalJacob_sym(l, xi, L, r)
% This function computes the symbolic Local Jacobians of Position vector and the
% Rotation matrix. However, the rotation matrix is [3x(3x2)]. Because, our
% arm has only 2 DoF and, we stack R = [R_l2, R_l3], where R_L2 is the
% Jacobian of R with respect to the l2 variable.
% 
% These matrices are used to develop Angular and velocity Jacobians and the
% Hessian matrix.
% 
% The derivations are referenced from following paper.
%   * Godage, Isuru S., Robert J. Webster, and Ian D. Walker. "Center-of-gravity-based 
%     approach for modeling dynamics of multisection continuum arms." IEEE transactions 
%     on robotics 35, no. 5 (2019): 1097-1108.
% 
% Inputs:
%   l   : length change of the PMA [3x1] [constant] (m)
%   xi  : selection factor of the backbone. xi=0 is the base and xi=1 is
%         the tip. [constant] {0,1}
%   L   : Length of the continuum arm [constant] (m)
%   r   : radial offset of the PMA [constant] (m)
% 
% Outputs:
%   PosJ    : Jacobian matrix of the position with respect to l2 and l3
%             [3x2]
%   RotJ    : Jacobian matrix of the rotation matrix with respect to l2 and
%             l3 [3x6]

arguments (Input)
    l (1,3) sym
    xi (1,1) double {mustBeBetween(xi, 0, 1, "closed")} = 1
    L (1,1) double {mustBeGreaterThanOrEqual(L, 0)} = 0.278
    r (1,1) double {mustBePositive} = 0.013
end

arguments (Output)
    PosJ (3,2) sym
    RotJ (3,6) sym
end

PosJ = [(-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6 / 0.8505e4 + 0.2e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 4 - r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2 / 0.9e1 + r ^ 6) * L * xi ^ 2 / r ^ 7 / 0.2e1 + (l(2) + l(3)) * (-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (0.2e1 * l(2) + l(3)) / 0.2835e4 + 0.4e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 4 * (0.2e1 * l(2) + l(3)) - r ^ 4 * (0.2e1 * l(2) + l(3)) * xi ^ 2 / 0.9e1) * L * xi ^ 2 / r ^ 7 / 0.2e1 (-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6 / 0.8505e4 + 0.2e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 4 - r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2 / 0.9e1 + r ^ 6) * L * xi ^ 2 / r ^ 7 / 0.2e1 + (l(2) + l(3)) * (-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (l(2) + 0.2e1 * l(3)) / 0.2835e4 + 0.4e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 4 * (l(2) + 0.2e1 * l(3)) - r ^ 4 * (l(2) + 0.2e1 * l(3)) * xi ^ 2 / 0.9e1) * L * xi ^ 2 / r ^ 7 / 0.2e1; -(-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (0.2e1 * l(2) + l(3)) / 0.2835e4 + 0.4e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 4 * (0.2e1 * l(2) + l(3)) - r ^ 4 * (0.2e1 * l(2) + l(3)) * xi ^ 2 / 0.9e1) * L * sqrt(0.3e1) * xi ^ 2 * (-l(3) + l(2)) / r ^ 7 / 0.6e1 - (-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6 / 0.8505e4 + 0.2e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 4 - r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2 / 0.9e1 + r ^ 6) * L * sqrt(0.3e1) * xi ^ 2 / r ^ 7 / 0.6e1 -(-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (l(2) + 0.2e1 * l(3)) / 0.2835e4 + 0.4e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 4 * (l(2) + 0.2e1 * l(3)) - r ^ 4 * (l(2) + 0.2e1 * l(3)) * xi ^ 2 / 0.9e1) * L * sqrt(0.3e1) * xi ^ 2 * (-l(3) + l(2)) / r ^ 7 / 0.6e1 + (-(l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6 / 0.8505e4 + 0.2e1 / 0.405e3 * r ^ 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 4 - r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2 / 0.9e1 + r ^ 6) * L * sqrt(0.3e1) * xi ^ 2 / r ^ 7 / 0.6e1; L * xi * (-0.2e1 / 0.9e1 * xi ^ 2 * (0.2e1 * l(2) + l(3)) * r ^ 6 + 0.4e1 / 0.135e3 * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 * (0.2e1 * l(2) + l(3)) - 0.4e1 / 0.2835e4 * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * r ^ 2 * (0.2e1 * l(2) + l(3)) + 0.8e1 / 0.229635e6 * xi ^ 8 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * (0.2e1 * l(2) + l(3))) / r ^ 8 L * xi * (-0.2e1 / 0.9e1 * xi ^ 2 * (l(2) + 0.2e1 * l(3)) * r ^ 6 + 0.4e1 / 0.135e3 * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 * (l(2) + 0.2e1 * l(3)) - 0.4e1 / 0.2835e4 * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * r ^ 2 * (l(2) + 0.2e1 * l(3)) + 0.8e1 / 0.229635e6 * xi ^ 8 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * (l(2) + 0.2e1 * l(3))) / r ^ 8;];

Rot2J = [((3 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 8 * (l(2) + l(3)) ^ 2 * (2 * l(2) + l(3)) + 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 8 * (l(2) + l(3)) - 84 * (l(2) + l(3)) * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * r ^ 2 - 84 * (l(2) + l(3)) ^ 2 * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 2 * (2 * l(2) + l(3)) + 1890 * (l(2) + l(3)) * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 + 945 * (l(2) + l(3)) ^ 2 * xi ^ 4 * (2 * l(2) + l(3)) * r ^ 4 - 17010 * (l(2) + l(3)) * xi ^ 2 * r ^ 6) / r ^ 8) / 0.17010e5 sqrt(0.3e1) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (2 * l(2) + l(3))) / 0.2835e4 + 0.4e1 / 0.405e3 * (r ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (xi ^ 4) * (2 * l(2) + l(3)) - (r ^ 4 * (2 * l(2) + l(3)) * xi ^ 2) / 0.9e1) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) / (r ^ 8) / 0.6e1 (-0.2e1 / 0.9e1 * (xi ^ 2) * (2 * l(2) + l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (2 * l(2) + l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (2 * l(2) + l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (2 * l(2) + l(3))) * xi * (l(2) + l(3)) / (r ^ 9) + ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * xi / (r ^ 9); sqrt(0.3e1) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (2 * l(2) + l(3))) / 0.2835e4 + 0.4e1 / 0.405e3 * (r ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (xi ^ 4) * (2 * l(2) + l(3)) - (r ^ 4 * (2 * l(2) + l(3)) * xi ^ 2) / 0.9e1) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) / (r ^ 8) / 0.6e1 ((3 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 8 * (-l(3) + l(2)) ^ 2 * (2 * l(2) + l(3)) + 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 8 * (-l(3) + l(2)) + (-252 * r ^ 2 * l(2) ^ 5 + 252 * r ^ 2 * l(2) ^ 2 * l(3) ^ 3) * xi ^ 6 + 1890 * (-l(3) + l(2)) * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 + 945 * (-l(3) + l(2)) ^ 2 * xi ^ 4 * (2 * l(2) + l(3)) * r ^ 4 - 17010 * (-l(3) + l(2)) * xi ^ 2 * r ^ 6) / r ^ 8) / 0.51030e5 -(-0.2e1 / 0.9e1 * (xi ^ 2) * (2 * l(2) + l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (2 * l(2) + l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (2 * l(2) + l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (2 * l(2) + l(3))) * sqrt(0.3e1) * (-l(3) + l(2)) * xi / (r ^ 9) / 0.3e1 - ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * sqrt(0.3e1) * xi / (r ^ 9) / 0.3e1; -(-0.2e1 / 0.9e1 * (xi ^ 2) * (2 * l(2) + l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (2 * l(2) + l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (2 * l(2) + l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (2 * l(2) + l(3))) * xi * (l(2) + l(3)) / (r ^ 9) - ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * xi / (r ^ 9) (-0.2e1 / 0.9e1 * (xi ^ 2) * (2 * l(2) + l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (2 * l(2) + l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (2 * l(2) + l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (2 * l(2) + l(3))) * sqrt(0.3e1) * (-l(3) + l(2)) * xi / (r ^ 9) / 0.3e1 + ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * sqrt(0.3e1) * xi / (r ^ 9) / 0.3e1 ((-20 * xi ^ 10 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4 * (2 * l(2) + l(3)) + 1080 * xi ^ 8 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * r ^ 2 * (2 * l(2) + l(3)) - 34020 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * r ^ 4 * (2 * l(2) + l(3)) + 510300 * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 6 * (2 * l(2) + l(3)) - 2296350 * xi ^ 2 * (2 * l(2) + l(3)) * r ^ 8) / r ^ 10) / 0.3444525e7;];
Rot3J = [((3 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 8 * (l(2) + l(3)) ^ 2 * (l(2) + 2 * l(3)) + 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 8 * (l(2) + l(3)) - 84 * (l(2) + l(3)) * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * r ^ 2 - 84 * (l(2) + l(3)) ^ 2 * xi ^ 6 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 2 * (l(2) + 2 * l(3)) + 1890 * (l(2) + l(3)) * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 + 945 * (l(2) + l(3)) ^ 2 * xi ^ 4 * (l(2) + 2 * l(3)) * r ^ 4 - 17010 * (l(2) + l(3)) * xi ^ 2 * r ^ 6) / r ^ 8) / 0.17010e5 -sqrt(0.3e1) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (l(2) + 2 * l(3))) / 0.2835e4 + 0.4e1 / 0.405e3 * (r ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (xi ^ 4) * (l(2) + 2 * l(3)) - (r ^ 4 * (l(2) + 2 * l(3)) * xi ^ 2) / 0.9e1) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) / (r ^ 8) / 0.6e1 (-0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) + 2 * l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (l(2) + 2 * l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (l(2) + 2 * l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (l(2) + 2 * l(3))) * xi * (l(2) + l(3)) / (r ^ 9) + ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * xi / (r ^ 9); -sqrt(0.3e1) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * (l(2) + 2 * l(3))) / 0.2835e4 + 0.4e1 / 0.405e3 * (r ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (xi ^ 4) * (l(2) + 2 * l(3)) - (r ^ 4 * (l(2) + 2 * l(3)) * xi ^ 2) / 0.9e1) * (xi ^ 2) * (l(2) + l(3)) / (r ^ 8) / 0.6e1 + sqrt(0.3e1) * (-l(3) + l(2)) * (-((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 6) / 0.8505e4 + 0.2e1 / 0.405e3 * (r ^ 2) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (xi ^ 4) - (r ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * xi ^ 2) / 0.9e1 + (r ^ 6)) * (xi ^ 2) / (r ^ 8) / 0.6e1 ((3 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 8 * (-l(3) + l(2)) ^ 2 * (l(2) + 2 * l(3)) - 2 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * xi ^ 8 * (-l(3) + l(2)) + (252 * r ^ 2 * l(2) ^ 3 * l(3) ^ 2 - 252 * r ^ 2 * l(3) ^ 5) * xi ^ 6 - 1890 * (-l(3) + l(2)) * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 4 + 945 * (-l(3) + l(2)) ^ 2 * xi ^ 4 * (l(2) + 2 * l(3)) * r ^ 4 + 17010 * (-l(3) + l(2)) * xi ^ 2 * r ^ 6) / r ^ 8) / 0.51030e5 -(-0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) + 2 * l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (l(2) + 2 * l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (l(2) + 2 * l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (l(2) + 2 * l(3))) * sqrt(0.3e1) * (-l(3) + l(2)) * xi / (r ^ 9) / 0.3e1 + ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * sqrt(0.3e1) * xi / (r ^ 9) / 0.3e1; -(-0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) + 2 * l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (l(2) + 2 * l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (l(2) + 2 * l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (l(2) + 2 * l(3))) * xi * (l(2) + l(3)) / (r ^ 9) - ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * xi / (r ^ 9) (-0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) + 2 * l(3)) * (r ^ 6) + 0.4e1 / 0.135e3 * (xi ^ 4) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 4) * (l(2) + 2 * l(3)) - 0.4e1 / 0.2835e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 2) * (l(2) + 2 * l(3)) + 0.8e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (l(2) + 2 * l(3))) * sqrt(0.3e1) * (-l(3) + l(2)) * xi / (r ^ 9) / 0.3e1 - ((r ^ 8) - 0.2e1 / 0.9e1 * (xi ^ 2) * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * (r ^ 6) + 0.2e1 / 0.135e3 * (xi ^ 4) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2) * (r ^ 4) - 0.4e1 / 0.8505e4 * (xi ^ 6) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3) * (r ^ 2) + 0.2e1 / 0.229635e6 * (xi ^ 8) * ((l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4)) * sqrt(0.3e1) * xi / (r ^ 9) / 0.3e1 ((-20 * xi ^ 10 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 4 * (l(2) + 2 * l(3)) + 1080 * xi ^ 8 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 3 * r ^ 2 * (l(2) + 2 * l(3)) - 34020 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) ^ 2 * xi ^ 6 * r ^ 4 * (l(2) + 2 * l(3)) + 510300 * xi ^ 4 * (l(2) ^ 2 + l(2) * l(3) + l(3) ^ 2) * r ^ 6 * (l(2) + 2 * l(3)) - 2296350 * xi ^ 2 * (l(2) + 2 * l(3)) * r ^ 8) / r ^ 10) / 0.3444525e7;];

RotJ = [Rot2J,Rot3J];

end